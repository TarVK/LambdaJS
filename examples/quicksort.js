v = _=>($Y=>($D0=>($D1=>$D0(_)(_=>$0=>$1=>$2=>$3=>$4=>$5=>$6=>$7=>$0(_))(_=>False=>$D0(_)(_=>$0=>$1=>$2=>$3=>$4=>$5=>$6=>$7=>$1(_))(_=>True=>$D0(_)(_=>$0=>$1=>$2=>$3=>$4=>$5=>$6=>$7=>$2(_))(_=>Undefined=>$D0(_)(_=>$0=>$1=>$2=>$3=>$4=>$5=>$6=>$7=>$8=>$9=>$5(_)($0)($1))(_=>Cons=>$D0(_)(_=>$0=>$1=>$2=>$3=>$4=>$5=>$6=>$7=>$8=>$5(_)($0))(_=>S=>$D0(_)(_=>$0=>$1=>$2=>$3=>$4=>$5=>$6=>$7=>$5(_))(_=>Nill=>$D0(_)(_=>$0=>$1=>$2=>$3=>$4=>$5=>$6=>$7=>$6(_))(_=>Z=>$D0(_)(_=>$0=>$1=>$2=>$3=>$4=>$5=>$6=>$7=>$8=>$9=>$9(_)($0)($1))(_=>Pair=>$D1(_)(_=>lessThan=>$0=>$0(_)(_=>$1=>$1(_)(_=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$1$0=>$1$1=>Undefined(_))(_=>$1$0=>Undefined(_))(_=>Undefined(_))(_=>False(_))(_=>$1$0=>$1$1=>Undefined(_)))(_=>$1=>$1(_)(_=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$1$0=>$1$1=>Undefined(_))(_=>$1$0=>Undefined(_))(_=>Undefined(_))(_=>False(_))(_=>$1$0=>$1$1=>Undefined(_)))(_=>$1=>$1(_)(_=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$1$0=>$1$1=>Undefined(_))(_=>$1$0=>Undefined(_))(_=>Undefined(_))(_=>False(_))(_=>$1$0=>$1$1=>Undefined(_)))(_=>$0$0=>$0$1=>$1=>$1(_)(_=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$1$0=>$1$1=>Undefined(_))(_=>$1$0=>Undefined(_))(_=>Undefined(_))(_=>False(_))(_=>$1$0=>$1$1=>Undefined(_)))(_=>$0$0=>$1=>$1(_)(_=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$1$0=>$1$1=>Undefined(_))(_=>$1$0=>lessThan(_)(_=>$0$0(_))(_=>$1$0(_)))(_=>Undefined(_))(_=>False(_))(_=>$1$0=>$1$1=>Undefined(_)))(_=>$1=>$1(_)(_=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$1$0=>$1$1=>Undefined(_))(_=>$1$0=>Undefined(_))(_=>Undefined(_))(_=>False(_))(_=>$1$0=>$1$1=>Undefined(_)))(_=>$1=>$1(_)(_=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$1$0=>$1$1=>Undefined(_))(_=>$1$0=>True(_))(_=>Undefined(_))(_=>False(_))(_=>$1$0=>$1$1=>Undefined(_)))(_=>$0$0=>$0$1=>$1=>$1(_)(_=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$1$0=>$1$1=>Undefined(_))(_=>$1$0=>Undefined(_))(_=>Undefined(_))(_=>False(_))(_=>$1$0=>$1$1=>Undefined(_))))(_=>lessThan=>$D0(_)(_=>$0=>$1=>$1(_)(_=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$1$0=>$1$1=>Undefined(_))(_=>$1$0=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$1$0=>$1$1=>$2=>$2(_)(_=>Pair(_)(_=>$1$0(_))(_=>(Cons(_)(_=>$0(_))(_=>$1$1(_)))))(_=>Pair(_)(_=>(Cons(_)(_=>$0(_))(_=>$1$0(_))))(_=>$1$1(_)))(_=>Undefined(_))(_=>$2$0=>$2$1=>Undefined(_))(_=>$2$0=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$2$0=>$2$1=>Undefined(_))))(_=>append=>$D1(_)(_=>partition=>$0=>$1=>$1(_)(_=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$1$0=>$1$1=>append(_)(_=>$1$0(_))(_=>(partition(_)(_=>$0(_))(_=>$1$1(_))))(_=>(lessThan(_)(_=>$1$0(_))(_=>$0(_)))))(_=>$1$0=>Undefined(_))(_=>Pair(_)(_=>Nill(_))(_=>Nill(_)))(_=>Undefined(_))(_=>$1$0=>$1$1=>Undefined(_)))(_=>partition=>$D1(_)(_=>concat=>$0=>$0(_)(_=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$0$0=>$0$1=>$1=>Cons(_)(_=>$0$0(_))(_=>(concat(_)(_=>$0$1(_))(_=>$1(_)))))(_=>$0$0=>Undefined(_))(_=>$1=>$1(_))(_=>Undefined(_))(_=>$0$0=>$0$1=>Undefined(_)))(_=>concat=>$D1(_)(_=>quicksort=>$0=>$0(_)(_=>$1=>$1(_)(_=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$1$0=>$1$1=>Undefined(_))(_=>$1$0=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$1$0=>$1$1=>concat(_)(_=>(quicksort(_)(_=>$1$0(_))))(_=>(Cons(_)(_=>$0(_))(_=>(quicksort(_)(_=>$1$1(_))))))))(_=>$1=>$1(_)(_=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$1$0=>$1$1=>Undefined(_))(_=>$1$0=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$1$0=>$1$1=>concat(_)(_=>(quicksort(_)(_=>$1$0(_))))(_=>(Cons(_)(_=>$0(_))(_=>(quicksort(_)(_=>$1$1(_))))))))(_=>$1=>$1(_)(_=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$1$0=>$1$1=>Undefined(_))(_=>$1$0=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$1$0=>$1$1=>concat(_)(_=>(quicksort(_)(_=>$1$0(_))))(_=>(Cons(_)(_=>$0(_))(_=>(quicksort(_)(_=>$1$1(_))))))))(_=>$0$0=>$0$1=>quicksort(_)(_=>$0$0(_))(_=>(partition(_)(_=>$0$0(_))(_=>$0$1(_)))))(_=>$0$0=>$1=>$1(_)(_=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$1$0=>$1$1=>Undefined(_))(_=>$1$0=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$1$0=>$1$1=>concat(_)(_=>(quicksort(_)(_=>$1$0(_))))(_=>(Cons(_)(_=>$0(_))(_=>(quicksort(_)(_=>$1$1(_))))))))(_=>Nill(_))(_=>$1=>$1(_)(_=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$1$0=>$1$1=>Undefined(_))(_=>$1$0=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$1$0=>$1$1=>concat(_)(_=>(quicksort(_)(_=>$1$0(_))))(_=>(Cons(_)(_=>$0(_))(_=>(quicksort(_)(_=>$1$1(_))))))))(_=>$0$0=>$0$1=>$1=>$1(_)(_=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$1$0=>$1$1=>Undefined(_))(_=>$1$0=>Undefined(_))(_=>Undefined(_))(_=>Undefined(_))(_=>$1$0=>$1$1=>concat(_)(_=>(quicksort(_)(_=>$1$0(_))))(_=>(Cons(_)(_=>$0(_))(_=>(quicksort(_)(_=>$1$1(_)))))))))(_=>quicksort=>$D0(_)(_=>Z(_))(_=>v0=>$D0(_)(_=>S(_)(_=>v0(_)))(_=>v1=>$D0(_)(_=>S(_)(_=>v1(_)))(_=>v2=>$D0(_)(_=>S(_)(_=>v2(_)))(_=>v3=>$D0(_)(_=>S(_)(_=>v3(_)))(_=>v4=>$D0(_)(_=>Cons(_)(_=>v3(_))(_=>(Cons(_)(_=>v4(_))(_=>(Cons(_)(_=>v1(_))(_=>(Cons(_)(_=>v0(_))(_=>Nill(_)))))))))(_=>list=>quicksort(_)(_=>list(_))))))))))))))))))))))(_=>$0=>c=>(f=>c(_)(f))(_=>$Y(_)($0))))(_=>$0=>c=>c(_)($0)))(_=>f=>(x=>f(_)(_=>x(x)))(x=>f(_)(_=>x(x))))

encode=r=>{let t=[...r.split(/\s*(?:\b|(?=[)]))\s*/),null],n=0,e=r=>t[n]==r,l=()=>t[n++],u={"False":[0,_=>$0=>$1=>$2=>$3=>$4=>$5=>$6=>$7=>$0(_)],"True":[0,_=>$0=>$1=>$2=>$3=>$4=>$5=>$6=>$7=>$1(_)],"Undefined":[0,_=>$0=>$1=>$2=>$3=>$4=>$5=>$6=>$7=>$2(_)],"Cons":[2,_=>$a0=>$a1=>$0=>$1=>$2=>$3=>$4=>$5=>$6=>$7=>$3(_)($a0)($a1)],"S":[1,_=>$a0=>$0=>$1=>$2=>$3=>$4=>$5=>$6=>$7=>$4(_)($a0)],"Nill":[0,_=>$0=>$1=>$2=>$3=>$4=>$5=>$6=>$7=>$5(_)],"Z":[0,_=>$0=>$1=>$2=>$3=>$4=>$5=>$6=>$7=>$6(_)],"Pair":[2,_=>$a0=>$a1=>$0=>$1=>$2=>$3=>$4=>$5=>$6=>$7=>$7(_)($a0)($a1)],},o=()=>{let r=!1;e("(")&&(l(),r=!0);let t=l();if(!(t in u))throw Error(`Unknown function "${t}"`);let[n,s]=u[t],i=s(r=>r);for(let f=0;f<n;f++){if(e(")")||e(null))throw Error(`Constructor "${t}" requires ${n} arguments`);i=i(o())}if(r&&!(e(")")||e(null)))throw Error(`Constructor "${t}" requires ${n} arguments`);return e(")")&&l(),r=>i};return o()};

decode = val=>val(_=>_)(_=>"(False"+")")(_=>"(True"+")")(_=>"(Undefined"+")")(_=>$0=>$1=>"(Cons"+" "+decode($0)+" "+decode($1)+")")(_=>$0=>"(S"+" "+decode($0)+")")(_=>"(Nill"+")")(_=>"(Z"+")")(_=>$0=>$1=>"(Pair"+" "+decode($0)+" "+decode($1)+")")

console.log(decode(v));